jQuery(function(a){String.prototype.pidUcfirst=function(){var a=this;return a.charAt(0).toUpperCase()+a.slice(1)},a("a[href=#siManageBtn]").click(function(){a(".scElps ._first").each(function(){a(this).css("width",a(this).width()-30+"px")}),a(".scCheck").show("slow");var b=a(this).next();return a("select",b).change(function(){var b=a(this).val()||"",c=[];return a("input[name=cart]:checked").each(function(b){c[b]=a(this).val()}),c.length<1?alert("Please select the items.",this)||!1:void exec_json("beluxe.procBeluxeChangeCustomStatus",{mid:current_mid,new_value:b,target_srls:c.join(",")},completeCallModuleAction)}),a("a[data-type]",b).click(function(){switch(a(this).attr("data-type")){case"manage":popopen(request_uri+"?module=document&act=dispDocumentManageDocument","manageDocument");break;case"admin":location.href=current_url.setQuery("act","dispBeluxeAdminModuleInfo")}return!1}),b.show("slow"),a(this).hide().prevAll().hide(),!1}),a("#siCat.tabn,#siCat.colm").each(function(){var b=a(this),c=b.hasClass("colm"),d=a("ul",this),e=a("li.active:last",this),f=parseInt(d.css("margin-top"))||0,g=parseInt(d.height())-f,h=parseInt(a("li:first",this).height())+parseInt(a("li:first",this).css("margin-bottom")),i=parseInt((e.position(b)?e.position(b).top:0)/h);if(i>0&&d.css("margin-top",i*h*-1+"px"),h>=g?(a(".scCaNavi",this).css("display","none"),d.css("margin-right",c?"18px":"0")):(a(".scCaNavi a:eq(0)",this).click(function(){var a=parseInt(d.css("margin-top"));return f>a&&d.css("margin-top",a+h+f+"px"),!1}),a(".scCaNavi a:eq(1)",this).click(function(){var a=parseInt(d.css("margin-top"));return a-h-f>-g&&d.css("margin-top",a-h-f+"px"),!1})),c){var j=a("#siLst:not(.noheader):eq(0), #siHrm:not(.noheader):eq(0)"),k=a(".scCaLock",this),l=getCookie("scCaLock");if(!j.length)return;j.length>1&&(j=a(j.get(0))),b.css({display:"none",visibility:"visible"}),b.css({top:j.position().top+"px",width:j.width()-10+"px"}),b.on("fadeIn.fast",function(){a(this).css({top:j.position().top+"px",width:j.width()-10+"px"}).fadeIn("fast")}).on("fadeOut.fast",function(){b.fadeOut()}),k&&(k.click(function(){return a(this).hasClass("active")?(a(this).removeClass("active"),setCookie("scCaLock","hide",null,"/")):(a(this).addClass("active"),setCookie("scCaLock","",null,"/")),!1}),"hide"==l&&k.removeClass("active")),"true"==b.attr("data-autohide")&&(a("thead tr:first th:not(.sort), ul.scFrm:first",j).mouseenter(function(c){var d=c.target,e=a("> span.sort:eq(0)",d);e.length&&c.offsetX>e.position().left||b.trigger("fadeIn.fast")}),a(document).mousemove(function(c){var d=c.target;a(d).parents().add(d).index(b)>-1||b.is(":hidden")||"1"!=b.css("opacity")||k.hasClass("active")||b.fadeOut()}))}}),a("#siLst.gall .scInfo[data-autohide=true]").each(function(){var b=a(this),c=b.closest(".scItem"),d=a(".nick_name",this),e=b.prev("span.prtImg"),f="true"==b.attr("data-fade");c.mouseenter(function(a){e.hide("slow"),f?b.fadeIn("slow"):b.slideDown(),d.show("slow")}).mouseleave(function(a){d.hide("slow"),f?b.fadeOut():b.slideUp(),e.show("slow")})}),a(".scSns a").click(function(){var b,c=a("#siHrm li.scElps strong:eq(0)"),d=a(this).attr("data-type"),e=encodeURIComponent(c.text().trim()),f=encodeURIComponent(c.attr("title"));switch(d){case"fa":b="http://www.facebook.com/share.php?t="+e+"&u="+f;break;case"de":b="http://www.delicious.com/save?v=5&noui&jump=close&url="+f+"&title="+e;break;default:b="http://twitter.com/home?status="+e+" "+f}return popopen(b,"_pop_sns"),!1}),a("a[href=#popopen][data-srl]").click(function(){var b=a(this).attr("data-srl")||"";return b&&popopen(b.setQuery("is_poped","1"),"beluxePopup"),!1}),a("a[href=#tbk_action][class=delete]").click(function(){if(!confirm("Do you want to delete the selected trackback?"))return!1;var b=a(this).closest("li").find("a[name^=trackback_]").attr("name").replace(/.*_/g,"");return exec_json("beluxe.procBeluxeDeleteTrackback",{mid:current_mid,trackback_srl:b},completeCallModuleAction),!1}),a("a[href=#his_action][data-mode=delete][data-srl]").click(function(){if(!confirm("Do you want to delete the selected history?"))return!1;var b=a(this).attr("data-srl")||0,c=a(this).attr("data-doc")||0;return exec_json("beluxe.procBeluxeDeleteHistory",{mid:current_mid,history_srl:b,document_srl:c},completeCallModuleAction),!1}),a("a[href^=#][href$=recommend][data-type]").click(function(){var b=a(this),c=b.attr("href"),d=b.attr("data-type"),e=b.attr("data-srl"),f={target_srl:e,cur_mid:current_mid,mid:current_mid};return exec_json(d+".proc"+d.pidUcfirst()+("#recommend"==c?"VoteUp":"VoteDown"),f,function(a){if(alert(a.message),0===a.error){var d=b.find("em.cnt");d.text((parseInt(d.text())||0)+("#recommend"==c?1:-1))}}),!1}),a("a[href=#declare][data-type]").click(function(){var b,c,d=a(this),e=d.attr("data-type"),f=d.attr("data-srl"),g=d.attr("data-rec")||"0";return b=prompt(_DXS_MSGS_.declare,""),"string"!=typeof b?!1:b.trim()?(exec_json(e+".proc"+e.pidUcfirst()+"Declare",{target_srl:f,cur_mid:current_mid,mid:current_mid},function(a){if(alert(a.message),0===a.error&&"0"!=g){var c="[Board DX] Declare, received messages: "+f,d=current_url.setQuery("comment_srl","comment"==e?f:"");b=b+'<br /><br /><a href="'+d+'">'+d+"</a>",exec_json("communication.procCommunicationSendMessage",{receiver_srl:g,title:c,content:b},function(a){0!==a.error&&alert(a.message)})}}),!1):(c=a('<div class="dxc_minimsg">').html("Please enter the message."),d.parent().after(c),c.delay(3e3).fadeOut(2500,function(){a(this).remove()}),!1)}),a(".btnAdopt button[data-adopt-srl]").click(function(){var b,c=a(this),d=c.attr("data-adopt-srl")||"",e=c.attr("data-adopt-name")||"";return b=prompt("Send thanks message to "+e,""),"string"!=typeof b?!1:b.trim()?(exec_json("beluxe.procBeluxeAdoptComment",{comment_srl:d,send_message:b},function(a){alert(a.message),0===a.error&&location.reload()}),!1):(tmp=a('<div class="dxc_minimsg">').html("Please enter the message."),c.parent().after(tmp),tmp.delay(3e3).fadeOut(2500,function(){a(this).remove()}),!1)}),a("#siFbk .scFbWt form textarea[name=content]").focus(function(){a(".scWusr",a(this).closest("form")).show("slow")}),a(".scHLink[data-href]").click(function(){return window.open(a(this).attr("data-href"),a(this).attr("data-target")||""),!1}),a(".scToggle[data-target]").click(function(){return a(a(this).attr("data-target")).slideToggle(),!1}),a(".scClipboard").click(function(){var b=a(this).attr("data-attr")||!1;return prompt("press CTRL+C copy it to clipboard...",b?a(this).attr(b):a(this).text()),!1}),a.fn.pidSettingWrite=function(){a(".scWcateList",this).change(function(){var b=a(this).val(),c=a(this).data("key"),d=a(".scWcateList[data-key="+c+"]").hide("slow"),e=a(".scWcateList[data-key="+b+"]");a(this).data("key",b),a("input:hidden[name=category_srl]").val(b),a(".scWcateList[data-key="+d.data("key")+"]").hide("slow"),e.find(">option").length&&e.change().show("slow")}),a("input:hidden[name=category_srl]:eq(0)",this).each(function(){var b,c,d=a(this).val()||0;if(d>0)for(b=0;3>b&&(c=a(".scWcateList option[value="+d+"]").closest("select").val(d).data("key",d).change(),c&&c.attr("data-key"));b++)d=c.show("slow").attr("data-key");else a(".scWcateList:eq(0)").change()}),a(".scWul.extraKeys >li:hidden:eq(0)",this).each(function(){a("#siWrt .scExTog:hidden").show().click(function(){return a("#siWrt .scWul.extraKeys >li:hidden").show("slow"),a(this).hide(),!1})}),a("a[href=#insert_filelink]",this).click(function(){var b=a(this).closest("#insert_filelink").find("> input"),c=b.val(),d=a(this).attr("data-seq"),e=a(this).attr("data-srl");return void 0!==c&&c?(exec_json("beluxe.procBeluxeInsertFileLink",{mid:current_mid,sequence_srl:d,document_srl:e,filelink_url:c},function(b){if(a("[id^=ckeditor_instance_]").length){var c=xe.getApp("xeuploader");1===c.length?c[0].loadFilelist():c=a("#xefu-container-"+b.sequence_srl).xeUploader()}else a(".xpress-editor").length&&reloadFileList(uploaderSettings[b.sequence_srl])}),!1):(alert("Please enter the file url.\nvirtual type example: http://... #.mov"),b.focus(),!1)}),a("input[name=category_srl]").focusin(function(){console.log(this)})};try{var b,c,d,e=a(window.frameElement);e.is("[id=pidOframe]")&&(c=e.closest("html"),d=a("body",e[0].contentDocument||e[0].contentWindow.document),b=e.parent().parent(),a(".pid_modal-head:eq(0)",b).each(function(){var b=a("#__PID_MODAL_HEADER__",d||"");b.length&&(a(this).html("<div>"+b.html()+"</div>").show(),b.remove())}),a(".pid_modal-foot:eq(0)",b).each(function(){var b=a("#__PID_MODAL_FOOTER__",d||"");b.length&&(a(this).html("<div>"+b.html()+"</div>").show(),b.remove())}))}catch(f){}a(window).ready(function(){a("a[type^=example\\/modal]").pidModalWindow(c||"",!0),a("#siWrt:eq(0)").pidSettingWrite(),a("div[data-flash-fix=true]").pidModalFlashFix(),a("div[data-link-fix=true]").each(function(){a("a:not([target])",this).attr("target","_blank")}),"hide"!=getCookie("scCaLock")&&a("#siCat.colm").trigger("fadeIn.fast")}).load(function(){a("table#siLst").each(function(){var b=a(this),c=a("#siBody").parent().width(),d=b.outerWidth();if(d>c){var e=a("tr:eq(0) th.title",b).outerWidth()||150;if(tt=Math.floor((d-c+e)/(a("tr:eq(0) th",b).length-3)),!e||e>130)return;a("th, td",b).each(function(b){var c=a(this);if(!c.is(".title")){var d=c.width()-tt;c.css({"max-width":d>0?d:1})}})}}),a("#siFbk .scFbH + .scClst > .scFrm").each(function(){var b=a(this),c=b.outerWidth();400>c&&(a(".scFbt",b).css("width","auto"),a(".scCmtCon",b).css("margin-left","5px"))}),a(".scElps[data-active=true]").each(function(b){var c=a(this),d=a("> :eq(0)",c),e=a("> :eq(1)",c),f=c.width(),g=0;e.length&&(a("> img",e).length||e.text().trim()?g=e.addClass("_last").outerWidth(!0):e.remove()),d.css("width",f-g-5+"px").addClass("_first")}),a(".scContent [data-hottrack]").each(function(b){var d=a(this),e=d.attr("data-type"),f=d.attr("data-hottrack"),g=a('<a class="scHotTrack">').attr("href",f),h=d.outerWidth("gall"!==e)-("widg"===e?7:4);"TR"==d.get(0).tagName?d.find(">td:eq(0)").is(function(){g.prependTo(this).width(h),"lstc"===e&&g.height(d.outerHeight()+d.next().outerHeight())}):g.prependTo(this).width(h),d.is("[data-modal-key]")&&g.attr({type:"example/modal","data-footer":"__PID_MODAL_FOOTER__","data-header":"__PID_MODAL_HEADER__"}).pidModalWindow(c||"")}),a("#siFbk a[name^=comment][data-scroll=true]:last",d||"").is(function(){this.scrollIntoView(!0)}),a(".pid_ajax-form input:text:eq(0)").focus()})}),function(a){var b=function(){},c=new b;b.prototype.topIndex=function(b){var c=a("body",b),d=0;try{c.find("> *").each(function(){var b=parseInt(a(this).css("z-index")||0);b>d&&(d=b)})}catch(e){d=999999}return d+100},b.prototype.backDrop=function(b){var c=a("#pidModalBackdrop",b);return c.length||(c=a('<div id="pidModalBackdrop" class="pid_modal-backdrop">').appendTo(a("body",b)).hide()),c},b.prototype.iFrame=function(b,c){var d,e=a("#"+b,c);return e.length?e.not(".pid_modal-frame").addClass("pid_modal-target"):(d=a("body",c),e=a('<section id="'+b+'" class="pid_modal-frame">').appendTo(d).hide()),e.find(".pid_modal-body").length||e.append(a('<div class="pid_modal-body">')),e},b.prototype.waitMessage=function(b,d){var e=a("div.wait[data-modal-child=message]");e.length||(e=a('<div class="message update wait" data-modal-child="message">').html("<p>"+waiting_message+'<br />If time delays continue, <a href="'+b.setQuery("is_modal","")+'"><span>click here</span></a>.</p>'),a("body",d).append(e)),e.css({position:"fixed",top:10,left:10,zIndex:c.topIndex(d)})},a.fn.extend({pidModalgoUrl:function(b,d,e,f){var g=a(this),h=a("#pidOframe",g),i=function(b){var c=b.contentDocument||b.contentWindow.document;a("script[src*="+_PID_MODULE_+"]",c).length||(a(c).find("a").click(function(b){b.stopPropagation(),b.preventDefault(),parent.location.replace(a(this).attr("href"))}),h.pidModalAutoResize())};b=b.setQuery("is_modal",f),h.length?h.get(0).src=b:h=a('<iframe id="pidOframe" data-resize="'+d+'" allowTransparency="true" frameborder="0" scrolling="no" />').on("load",function(){a(this).parent().scrollTop(0),i(this),e(this)}).attr("src",b).appendTo(a(".pid_modal-body:eq(0)",g)),c.waitMessage(b,h.closest("html"))},pidModalSetTitle:function(b,c,d){var e,f,g,h=function(b){var c,d={"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"'};return c=new RegExp("("+a.map(d,function(a,b){return b}).join("|")+")","g"),b.replace(c,function(a,b){return d[b]})},i=a(this),j=h(b),k=h(c),l=["pid_modal-head","pid_modal-foot"];f=i.find("div."+l[0]),f.length||(f=a('<div class="'+l[0]+'">').hide().prependTo(i)),g=i.find("div."+l[1]),g.length||(g=a('<div class="'+l[1]+'">').hide().appendTo(i)),j&&":INHERIT:"!==j.substring(0,9)?(j=":GETHTML:"===j.substring(0,9)?a(j.substring(9)).html():"<div>"+j+"</div>",f.html(j).css("display",j?"block":"none")):j||f.html("").css("display","none"),k&&":INHERIT:"!==k.substring(0,9)?(k=":GETHTML:"===k.substring(0,9)?a(k.substring(9)).html():"<div>"+k+"</div>",g.html(k).css("display",k?"block":"none")):k||g.html("").css("display","none"),e=i.find(".pid_modal-close"),e.length||(e=a('<button type="button" title="press esc to close" class="pid_modal-close">&times;</button>').click(d),i.prepend(e))},pidModalAutoResize:function(){var b,d,e,f,g,h,i,j,k,l,m=a(this);if(e=m[0].contentDocument||m[0].contentWindow.document,void 0!==e){if(e=a("body",e),b=m.parent().parent(),$target=b.closest("body"),!e.text())return void b.hide();clearInterval(m.data("timer")||0),m.add(e.addClass("pid_modal-document")).scrollTop(0),f=a("div.pid_modal-head",b),h=a("div.pid_modal-body",b),g=a("div.pid_modal-foot",b),k=m.attr("data-resize")||"auto";var n=function(){return setInterval(function(){var a=e.outerHeight(!0);a>10&&(m.height()!==a&&m.height(a),h.height()!==a&&h.height(a)),b.find("#pidOframe").length||clearInterval(l)},500)},o=function(){return setInterval(function(){var a,c,n,o;i=d.outerWidth(!0),n=e.outerHeight(!0),b.width(i-80),n>10&&(j=d.outerHeight(!0),c=(f.outerHeight(!0)||0)+(g.outerHeight(!0)||0),o=j-c-100,o="hfix"===k||n>o?o:n,(m.height()!==n||h.height()!==o)&&(m.height(n),h.css({height:o+"px","overflow-y":n>o?"auto":"hidden"})),c=b.outerHeight(!0),a=Math.floor((j-c)/2-10),b.css({top:a>10?a:10,left:Math.floor((i-b.outerWidth(!0))/2)})),b.find("#pidOframe").length||clearInterval(l)},500)};b.is(".pid_modal-target")?(h.height(1),b.show(),l=n(),a("[data-modal-child=message]",$target).fadeOut(1500,function(){a(this).remove()})):(d=c.backDrop($target),b.show(),i=d.outerWidth(!0),b.width(i-80),h.height(1),b.position().left<1?b.animate({top:10,left:Math.floor((i-b.outerWidth(!0))/2)},{complete:function(){b.show(),l=o(),a("[data-modal-child=message]",$target).fadeOut(1500,function(){a(this).remove()})}}):l=o()),m.data("timer",l)}},pidModalWindow:function(b,d){this.not(".pid_modal-anchor").addClass("pid_modal-anchor").each(function(){var b=(a(this).attr("type")||"").split("/");"modal"===b[1]&&(this.modalId=b[2]?b[2]:"pidModalFrame")}).click(function(){var d=a(this),e=c.iFrame(this.modalId,b);return e.hide().css({top:"0",left:"-150%"}),d.trigger("open.mw"),!1}).bind("open.mw",function(){var e,f,g,h,i,j,k,l=a(this),m=0;if(h=a.Event("before-open.mw"),l.trigger(h),h.isDefaultPrevented())return!1;e=c.iFrame(this.modalId,b),e.is(".pid_modal-target")||e.pidModalSetTitle(l.attr("data-header")||l.attr("title")||"",l.attr("data-footer")||"",function(){return l.trigger("close.mw"),!1}),j=l.data("go-url")||l.attr("href")||"about:blank",k=e.is(".pid_modal-target")?3:1,"showing"!==e.data("state")&&(e.data("state","showing"),i=l.data("duration")||"fast",e.is(".pid_modal-target")?e.find("> *").hide(i,function(a){e.find("> div.pid_modal-body").show()}):(a(document).on("keydown.mw",function(a){return 27===a.which?(l.trigger("close.mw"),!1):void 0}),f=c.backDrop(b),f.css("z-index","1"),e.not(".pid_modal-target").css("z-index","2"),m=c.topIndex(b),g=a("body",b),f.data("body_overflow",g.css("overflow-x")).css("z-index",m).show(),f.css("z-index",m).show(),e.css("z-index",m+1).find("button.pid_modal-close:first").focus(),g.css("overflow-x","hidden"),d&&f.click(function(){return l.trigger("close.mw"),!1})));var n=function(a){l.trigger("after-open.mw",[a])};e.find("div.pid_modal-body").css("overflow-y","hidden"),e.pidModalgoUrl(j,l.attr("data-resize")||"auto",n,k)}).bind("close.mw",function(){var d,e,f,g,h=a(this);try{d=c.iFrame(this.modalId,b)}catch(i){return g=window.location.href.setQuery("is_modal","").setQuery("document_srl",""),window.parent.location.replace(g),!1}if(f=a.Event("before-close.mw"),h.trigger(f),f.isDefaultPrevented())return!1;g=h.data("duration")||"fast",d.data("state","hiding");var j=function(){h.trigger("after-close.mw")};d.is(".pid_modal-target")?d.find("> *").show(g,function(a){d.find("> div.pid_modal-head").hide(),d.find("> div.pid_modal-body").hide(),d.find("> div.pid_modal-foot").hide()}):(e=c.backDrop(b),d.fadeOut(g,function(){j(),a(this).not(".pid_modal-target").hide(),e.hide(),a("body",b).css("overflow-x",e.hide().data("body_overflow")||"auto"),a(this).find("> div.pid_modal-body").children().remove()}))})},pidModalFlashFix:function(){a("embed[type*=flash]").each(function(){var b=a(this);"transparent"!=b.attr("wmode"),b.attr("wmode","opaque")}),a("iframe[src*=youtube]").each(function(){var b=a(this);b.attr("src",b.attr("src").setQuery("wmode","opaque"))})}});try{var d=a(window.frameElement);d.is("[id=pidOframe]")&&(a(document).on("ready",function(){c.waitMessage(window.location.href,d.closest("html")),d.pidModalAutoResize(),a("[data-modal-hide]").on("click",function(){return d.parent().parent().find("button.pid_modal-close:first").click(),!1})}),a(window).on("unload",function(){d.parent().height(1).parent().hide().css({top:"0",left:"-150%"}),a("[data-modal-child=message]",d.closest("body")).remove()}))}catch(e){}}(jQuery);