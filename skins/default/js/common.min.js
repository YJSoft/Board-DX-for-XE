jQuery(function(a){String.prototype.updateQueryString=function(a,b){var c=this,d=new RegExp("([?|&])"+a+"=.*?(&|#|$)","i");if(c.match(d))return c.replace(d,"$1"+a+"="+b+"$2");var e="",f=-1!==c.indexOf("?")?"&":"?";return-1!==c.indexOf("#")&&(e=c.replace(/.*#/,"#"),c=c.replace(/#.*/,"")),c+f+a+"="+b+e};var b=function(a){},c=function(b){var c=(parent?parent:self).location,d="";if(b.success_return_url)d=b.success_return_url;else{d=c.href;for(var e in b)a.inArray(e,["error","message","message_type"])>-1||(d=d.updateQueryString(e,b[e]))}c.replace(d)};a("form.pid_ajax-form").submit(function(){var d={},e=a(this).serializeArray();if(a.each(e,function(b,c){var e=a.trim(c.value),f=c.name;return e&&f?(/\[\]$/.test(f)&&(f=f.replace(/\[\]$/,"")),void(d[f]?d[f]+="|@|"+e:d[f]=c.value)):!0}),/^\s*<p>.*<\/p>\s*$/i.test(d.content)){var f=d.content.toLowerCase(),g=f.indexOf("</p>"),h=f.lastIndexOf("</p>");g>0&&h>0&&g==h&&(d.content=content=d.content.replace(/^\s*<p>|<\/p>\s*$/gi,""))}return exec_json(d.mid+"."+d.act,d,c,b),!1}),a("a[href=#siManageBtn]").click(function(){a(".scElps ._first").each(function(){a(this).css("width",a(this).width()-30+"px")}),a(".scCheck").show("slow");var b=a(this).next();return a("select",b).change(function(){var b=a(this).val()||"",c=[];return a("input[name=cart]:checked").each(function(b){c[b]=a(this).val()}),c.length<1?alert("Please select the items.",this)||!1:void exec_json("beluxe.procBeluxeChangeCustomStatus",{mid:current_mid,new_value:b,target_srls:c.join(",")},completeCallModuleAction)}),a("a[data-type]",b).click(function(){switch(a(this).attr("data-type")){case"manage":popopen(request_uri+"?module=document&act=dispDocumentManageDocument","manageDocument");break;case"admin":location.href=current_url.setQuery("act","dispBeluxeAdminModuleInfo")}return!1}),b.show("slow"),a(this).hide().prevAll().hide(),!1}),a("#siCat.tabn,#siCat.colm").each(function(){var b=a(this),c=b.hasClass("colm"),d=a("ul",this),e=a("li.active:last",this),f=parseInt(d.css("margin-top"))||0,g=parseInt(d.height())-f,h=parseInt(a("li:first",this).height())+parseInt(a("li:first",this).css("margin-bottom")),i=parseInt((e.position(b)?e.position(b).top:0)/h);if(i>0&&d.css("margin-top",i*h*-1+"px"),h>=g?(a(".scCaNavi",this).css("display","none"),d.css("margin-right",c?"18px":"0")):(a(".scCaNavi a:eq(0)",this).click(function(){var a=parseInt(d.css("margin-top"));return f>a&&d.css("margin-top",a+h+f+"px"),!1}),a(".scCaNavi a:eq(1)",this).click(function(){var a=parseInt(d.css("margin-top"));return a-h-f>-g&&d.css("margin-top",a-h-f+"px"),!1})),c){var j=a("#siLst:not(.noheader):eq(0), #siHrm:not(.noheader):eq(0)"),k=a(".scCaLock",this),l=getCookie("scCaLock");if(!j.length)return;j.length>1&&(j=a(j.get(0))),b.css({display:"none",visibility:"visible"}),b.css({top:j.position().top+"px",width:j.width()-10+"px"}),k&&(k.click(function(){return a(this).hasClass("active")?(a(this).removeClass("active"),setCookie("scCaLock","hide",null,"/")):(a(this).addClass("active"),setCookie("scCaLock","",null,"/")),!1}),"hide"==l&&k.removeClass("active")),"true"==b.attr("data-autohide")&&(a("thead tr:first th:not(.sort), ul.scFrm:first",j).mouseenter(function(c){var d=c.target,e=a("> span.sort:eq(0)",d);e.length&&c.offsetX>e.position().left||b.trigger("fadeIn.fast")}),a(document).mousemove(function(c){var d=c.target;a(d).parents().add(d).index(b)>-1||b.is(":hidden")||"1"!=b.css("opacity")||k.hasClass("active")||b.fadeOut()})),b.bind("fadeIn.fast",function(){a(this).css({top:j.position().top+"px",width:j.width()-10+"px"}).fadeIn("fast")}).bind("fadeOut.fast",function(){b.fadeOut()})}}),a("#siLst.gall .scInfo[data-autohide=true]").each(function(){var b=a(this),c=b.closest(".scItem"),d=a(".nick_name",this),e=b.prev("span.prtImg"),f="true"==b.attr("data-fade");c.mouseenter(function(a){e.hide("slow"),f?b.fadeIn("slow"):b.slideDown(),d.show("slow")}).mouseleave(function(a){d.hide("slow"),f?b.fadeOut():b.slideUp(),e.show("slow")})}),a(".scSns a").click(function(){var b,c=a("#siHrm li.scElps strong:eq(0)"),d=a(this).attr("data-type"),e=encodeURIComponent(c.text().trim()),f=encodeURIComponent(c.attr("title"));switch(d){case"me":b="http://me2day.net/posts/new?new_post[body]=%22"+e+"%22%3A"+f;break;case"fa":b="http://www.facebook.com/share.php?t="+e+"&u="+f;break;case"de":b="http://www.delicious.com/save?v=5&noui&jump=close&url="+f+"&title="+e;break;default:b="http://twitter.com/home?status="+e+" "+f}return popopen(b,"_pop_sns"),!1}),a("a[href=#tbk_action][class=delete]").click(function(){if(!confirm("Do you want to delete the selected trackback?"))return!1;var b=a(this).closest("li").find("a[name^=trackback_]").attr("name").replace(/.*_/g,"");return exec_json("beluxe.procBeluxeDeleteTrackback",{mid:current_mid,trackback_srl:b},completeCallModuleAction),!1}),a("a[href=#history][data-srl]").click(function(){var b=a(this).attr("data-srl")||0;return popopen(request_uri+"?mid="+current_mid+"&act=dispBoardHistory&history_srl="+b+"&is_poped=1","documentHistory"),!1}),a("a[href=#his_action][data-mode=delete][data-srl]").click(function(){if(!confirm("Do you want to delete the selected history?"))return!1;var b=a(this).attr("data-srl")||0,c=a(this).attr("data-doc")||0;return exec_json("beluxe.procBeluxeDeleteHistory",{mid:current_mid,history_srl:b,document_srl:c},completeCallModuleAction),!1}),a("a[href^=#][href$=recommend][data-type]").click(function(){var b=a(this),c=b.attr("href"),d=b.attr("data-type"),e=b.attr("data-srl"),f={target_srl:e,cur_mid:current_mid,mid:current_mid};return exec_json(d+".proc"+d.ucfirst()+("#recommend"==c?"VoteUp":"VoteDown"),f,function(a){if(alert(a.message),0===a.error){var d=b.find("em.cnt");d.text((parseInt(d.text())||0)+("#recommend"==c?1:-1))}}),!1}),a("a[href=#declare][data-type]").click(function(){var b,c,d=a(this),e=d.attr("data-type"),f=d.attr("data-srl"),g=d.attr("data-rec")||"0";return b=prompt(_PID_MSGS_.declare,""),"string"!=typeof b?!1:b.trim()?(exec_json(e+".proc"+e.ucfirst()+"Declare",{target_srl:f,cur_mid:current_mid,mid:current_mid},function(a){if(alert(a.message),0===a.error&&"0"!=g){var c="[Board DX] Declare, "+e+": "+f,d=current_url.setQuery("comment_srl","comment"==e?f:"");b=b+'<br /><br /><a href="'+d+'">'+d+"</a>",exec_json("communication.procCommunicationSendMessage",{receiver_srl:g,title:c,content:b},function(a){0!==a.error&&alert(a.message)})}}),!1):(c=a("<div>").html("Please enter the message."),d.parent().after(c),c.delay(2e3).fadeOut(2500,function(){a(this).remove()}),!1)}),a(".btnAdopt button[data-adopt-srl]").click(function(){var b,c=a(this),d=c.attr("data-adopt-srl")||"",e=c.attr("data-adopt-name")||"";return b=prompt("Send thanks message to "+e,""),"string"!=typeof b?!1:b.trim()?(exec_json("beluxe.procBeluxeAdoptComment",{comment_srl:d,send_message:b},function(a){alert(a.message),0===a.error&&location.reload()}),!1):(tmp=a("<div>").html("Please enter the message."),c.parent().after(tmp),tmp.delay(2e3).fadeOut(2500,function(){a(this).remove()}),!1)}),a("#siFbk .scFbWt form textarea[name=content]").focus(function(){a(".scWusr",a(this).closest("form")).show("slow")}),a(".scHLink[data-href]").click(function(){return window.open(a(this).attr("data-href"),a(this).attr("data-target")||""),!1}),a(".scToggle[data-target]").click(function(){return a(a(this).attr("data-target")).slideToggle(),!1}),a(".scClipboard").click(function(){var b=a(this).attr("data-attr")||!1;return prompt("press CTRL+C copy it to clipboard...",b?a(this).attr(b):a(this).text()),!1}),a.browser.msie===!0&&Math.floor(a.browser.version)<9&&a("#siLst thead tr th:not(hidden):last div").css("border-right-width","1px"),a(window).load(function(){a("table#siLst").each(function(){var b=a(this),c=a("#siBody").parent().width(),d=b.outerWidth();if(d>c){var e=a("tr:eq(0) th.title",b).outerWidth()||150;if(tt=Math.floor((d-c+e)/(a("tr:eq(0) th",b).length-3)),!e||e>130)return;a("th, td",b).each(function(b){var c=a(this);if(!c.is(".title")){var d=c.width()-tt;c.css({"white-space":c.is("th")?"":"normal","max-width":d>0?d:1})}})}}),a("#siFbk .scFbH + .scClst > .scFrm").each(function(){var b=a(this),c=b.outerWidth();400>c&&(a(".scFbt",b).css("width","auto"),a(".scCmtCon",b).css("margin-left","5px"))}),a(".scElps[data-active=true]").each(function(b){var c=a(this),d=a("> :eq(0)",c),e=a("> :eq(1)",c),f=c.width(),g=0;e.length&&(a("> img",e).length||e.text().trim()?g=e.addClass("_last").outerWidth(!0):e.remove()),a.browser.msie===!0&&d.height(c.css("line-height")||15),d.css("width",f-g-5+"px").addClass("_first")}),a(".scContent [data-hottrack]").each(function(b){var c=a(this),d=c.attr("data-index"),e=c.attr("data-type"),f=c.attr("data-hottrack"),g=a('<a class="scHotTrack" />').attr("data-index",d).attr("href",f),h=c.outerWidth("gall"!=e)-("widg"==e?8:4),i=c.outerHeight("webz"==e)+("lstcont"==e?a("#siHotCont_"+d).height():0)-4;if(g.css({width:h+"px",height:i+"px"}),"TR"==c.get(0).tagName){var j=c.find(">td:eq(0)");if(a.browser.mozilla===!0){var k=a("<span>").css({position:"relative",display:"block"}).css({"padding-left":j.css("padding-left"),"padding-top":j.css("padding-top")}).html(j.html());g.prependTo(k.prependTo(j.html("").css({"padding-left":"0","padding-top":"0","vertical-align":"top"})))}else g.prependTo(j.css({position:"relative"}))}else g.prependTo(c);a.browser.msie===!0&&a('<span class="iefix" />').css({width:h+"px",height:i+"px"}).appendTo(g)}),a(".pidModalAnchor").bind("before-open.mw",function(b){var c,d,e,f,g,h,i,j=a(this);if(c=j.attr("data-modal-act")||"",d=j.attr("data-modal-param")||"",c||d){for(f=d.split(","),h=f.length-1,i=f.length>0&&"true"==f[0]?1:0,e=i?default_url:current_url,e=e.setQuery("act",c),i&&(e=e.setQuery("mid",current_mid)),g=i;h>g;g+=2)e=e.setQuery(f[g],f[g+1]||"");j.data("goUrl",e)}}).bind("after-close.mw",function(b){a(".pid_modal-body",a(a(this).attr("href"))).css({top:0,left:"-150%",height:0})}),a("[data-modal-hide]").click(function(){return a(a(this).attr("href"),(parent?parent:self).document).find("button.pid_modal-close:first").click(),!1}).closest("form").each(function(){a(this).prepend(a('<button type="button" class="scModalClose"">&times;</button>').click(function(){return a("[data-modal-hide]:eq(0)").click(),!1}))}),"hide"!=getCookie("scCaLock")&&a("#siCat.colm").trigger("fadeIn.fast");var b=a("#siFbk a[name^=comment][data-scroll=true]").last().parent()[0];b&&b.scrollIntoView(!0),a("#siWrt").each(function(){a(".scWcateList",this).change(function(){var b=a(this).val(),c=a(this).data("key"),d=a(".scWcateList[data-key="+c+"]").hide("slow"),e=a(".scWcateList[data-key="+b+"]");a(this).data("key",b),a("input:hidden[name=category_srl]").val(b),a(".scWcateList[data-key="+d.data("key")+"]").hide("slow"),e.find(">option").length&&e.change().show("slow")}),a("input:hidden[name=category_srl]:eq(0)",this).each(function(){var b,c,d=a(this).val()||0;if(d>0)for(b=0;3>b&&(c=a(".scWcateList option[value="+d+"]").closest("select").val(d).data("key",d).change(),c&&c.attr("data-key"));b++)d=c.show("slow").attr("data-key");else a(".scWcateList:eq(0)").change()}),a(".scWul.extraKeys li.scWli:hidden:eq(0)",this).each(function(){a("#siWrt .scExTog:hidden").show().click(function(){return a("#siWrt .scWul.extraKeys li.scWli:hidden").show("slow"),a(this).hide(),!1})}),a("a[href=#insert_filelink]",this).click(function(){var b=a(this).closest("#insert_filelink").find("> input"),c=b.val(),d=a(this).attr("data-seq"),e=a(this).attr("data-srl");return void 0!==c&&c?(exec_json("Beluxe.procBeluxeInsertFileLink",{mid:current_mid,sequence_srl:d,document_srl:e,filelink_url:c},function(b){if(a("[id^=ckeditor_instance_]").length){var c=xe.getApp("xeuploader");1===c.length?c[0].loadFilelist():c=a("#xefu-container-"+b.sequence_srl).xeUploader()}else a(".xpress-editor").length&&reloadFileList(uploaderSettings[b.sequence_srl])}),!1):(alert("Please enter the file url.\nvirtual type example: http://... #.mov"),b.focus(),!1)})})})}),jQuery(function(a){a.fn.extend({everyTime:function(b,c,d,e){return this.each(function(){a.timer.add(this,b,c,d,e)})},oneTime:function(b,c,d){return this.each(function(){a.timer.add(this,b,c,d,1)})},stopTime:function(b,c){return this.each(function(){a.timer.remove(this,b,c)})}}),a.extend({timer:{global:[],guid:1,dataKey:"jQuery.timer",regex:/^([0-9]+(?:\.[0-9]*)?)\s*(.*s)?$/,powers:{ms:1,cs:10,ds:100,s:1e3,das:1e4,hs:1e5,ks:1e6},timeParse:function(b){if(void 0===b||null===b)return null;var c=this.regex.exec(a.trim(b.toString()));if(c[2]){var d=parseFloat(c[1]),e=this.powers[c[2]]||1;return d*e}return b},add:function(b,c,d,e,f){var g=0;if(a.isFunction(d)&&(f||(f=e),e=d,d=c),c=a.timer.timeParse(c),!("number"!=typeof c||isNaN(c)||0>c)){("number"!=typeof f||isNaN(f)||0>f)&&(f=0),f=f||0;var h=a.data(b,this.dataKey)||a.data(b,this.dataKey,{});h[d]||(h[d]={}),e.timerID=e.timerID||this.guid++;var i=function(){(++g>f&&0!==f||e.call(b,g)===!1)&&a.timer.remove(b,d,e)};i.timerID=e.timerID,h[d][e.timerID]||(h[d][e.timerID]=window.setInterval(i,c)),this.global.push(b)}},remove:function(b,c,d){var e=a.data(b,this.dataKey),f=null;if(e){if(c){if(e[c]){if(d)d.timerID&&(window.clearInterval(e[c][d.timerID]),delete e[c][d.timerID]);else for(var g in e[c])window.clearInterval(e[c][g]),delete e[c][g];for(f in e[c])break;f||(f=null,delete e[c])}}else for(c in e)this.remove(b,c,d);for(f in e)break;f||a.removeData(b,this.dataKey)}}}}),a(window).bind("unload",function(){a.each(a.timer.global,function(b,c){a.timer.remove(c)})}),a.fn.pidModalResize=function(b){var d=a(this),e=d.data("anchor").attr("data-target")||"",f=d.data("frame_id")||"pidOframe";b=b||"auto",a("#"+f,d).each(e?function(){var b=a(this),c=b.get(0).contentDocument||b.get(0).contentWindow.document;if(void 0!==c){var e=a("body",c),f=a("form:first",e);e.css({padding:"0",margin:"0",overflow:"hidden"}),f.css({padding:"0",margin:"0",overflow:"hidden"}),b.height(e.outerHeight(!0)),d.everyTime(500,"time_resize_event2",function(a){if(d.is(":hidden")||!b.length){if(d.stopTime("time_resize_event2"),!b.length)return;return void b.css("height","")}b.height(e.outerHeight(!0))})}}:function(){var e=a(this),f=a(parent),g=e.get(0).contentDocument||e.get(0).contentWindow.document;if(void 0!==g){var h=a("body",g),i=a("form:first",h);h.css({padding:"0",margin:"0",overflow:"hidden"}),i.css({padding:"0",margin:"0",overflow:"hidden"}),"hfix"==b&&h.height(f.height()-100),e.height(h.outerHeight(!0)),d.everyTime(500,"time_resize_event",function(b){var g=a(".pid_modal-body:eq(0)",d);if(d.is(":hidden")||!e.length)return void d.stopTime("time_resize_event");var i=f.height()-100,j=h.outerHeight(!0);h.css("overflow-y",i>j?"hidden":"auto"),e.css({height:i>j?j:i,width:f.width()-80}),g.height(e.outerHeight(!0));var k=(f.height()-g.outerHeight())/2-10;c={top:(k>10?k:10)+"px",left:(f.width()-g.outerWidth())/2+"px"},g.position().left<0?g.animate(c):g.css(c)})}}),a("[data-modal-child=message]",parent.document).fadeOut(2500,function(){a(this).remove()})}}),jQuery.fn.pidModalFlashFix=function(){var a=jQuery;a("embed[type*=flash]",this).each(function(){var b=a(this);"transparent"!=b.attr("wmode"),b.attr("wmode","opaque")}),a("iframe[src*=youtube]",this).each(function(){var b=a(this);b.attr("src",b.attr("src").setQuery("wmode","opaque"))})},jQuery(function(a){var b=27,c=[],d=1040,e=a('<div class="pid_modal-backdrop" style="width:100%;height:100%"></div>').appendTo("body").hide();a.fn.pidModalWindow=function(){this.not(".pid_modal-window").addClass("pid_modal-window").each(function(){a(a(this).attr("href")).hide()}).click(function(){var b,c=a(this);return b=a(c.attr("href")),c.trigger("showing"==b.data("state")?"close.mw":"open.mw"),!1}).bind("open.mw",function(){function f(){l.trigger("after-open.mw")}var g,h,i,j,k,l=a(this);if(g=a(l.attr("href")),k=l.attr("data-target")||"",!c.length||c[c.length-1].get(0)!=g.get(0)){if(k||g.parent("body").length?k&&("showing"==g.data("state")&&l.trigger("close.mw"),a(k).before(g)):(g.find("[data-modal-hide]").click(function(){g.data("anchor").trigger("close.mw")}),h=a('<button type="button" class="pid_modal-close">&times;</button>'),h.click(function(){g.data("anchor").trigger("close.mw")}),g.prepend(h),a("body").append(g)),g.data("anchor",l),i=a.Event("before-open.mw"),l.trigger(i),i.isDefaultPrevented())return!1;if(j=l.data("duration")||"fast",g.data("state","showing"),(!k||k&&a("[data-modal-hide]",g).length)&&a(document).bind("keydown.mw",function(a){return a.which==b?(l.trigger("close.mw"),!1):void 0}),g.fadeIn(j,f).find("button.pid_modal-close:first").focus(),k)a(k).hide("fast");else{a("body").css("overflow","hidden"),c.push(g);var m=d+2*(c.length-1);e.css("z-index",m).show();var n=e.height(),o=n;o-=g.find(".pid_modal-header:visible").height(),o-=g.find(".pid_modal-footer:visible").height(),o-=150,g.find(".pid_modal-body").css("height",o),g.css("z-index",m+1)}}}).bind("close.mw",function(){function b(){j.trigger("after-close.mw")}var f,g,h,i,j=a(this);if(g=a(j.attr("href")),!c.length||c[c.length-1].get(0)==g.get(0)){if(f=a.Event("before-close.mw"),j.trigger(f),f.isDefaultPrevented())return!1;if(h=j.data("duration")||"fast",g.data("state","hiding"),g.fadeOut(h,b),j.focus(),i=j.attr("data-target")||"")a(i).show("fast");else{a("body").css("overflow","auto"),c.pop();var k=d+2*(c.length-1);c.length?e.css("z-index",k):e.hide()}}})},a.fn.pidModalGoUrl=function(b){var c,d=a(this),e=d.attr("data-modal-frame")||"pidOframe",f=d.data("target")?a(window).scrollTop():0;return d.data("frame_id",e),a(".wait[data-modal-child=message]").length||(c=a('<div class="message update wait">').html("<p>"+waiting_message+'<br />If time delays continue, <a href="'+b.setQuery("is_modal","0")+'"><span>click here</span></a>.</p>').attr("data-modal-child","message").css({position:"absolute",left:"10px","z-index":"9"}).css("top",f+10+"px"),d.append(c)),"string"!=typeof scroll&&(scroll=""),b=b.setQuery("is_modal","1"),/msie|chromium|chrome/.test(navigator.userAgent.toLowerCase())===!0?a("#"+e,d).length?window.frames[e].location.replace(b):a('<iframe id="'+e+'" allowTransparency="true" frameborder="0" scrolling="'+(scroll?scroll:"auto")+'" />').attr("src",b).appendTo(a(".pid_modal-body:eq(0)",d)).load(function(a){d.pidModalResize(d.attr("data-modal-resize"))}):("no"==scroll&&(scroll="hidden"),a("#"+e,d).length?a("#"+e,d).attr("data",b):a('<object id="'+e+'" style="overflow-x:hidden;overflow-y:'+(scroll?scroll:"auto")+'" />').attr("data",b).appendTo(a(".pid_modal-body:eq(0)",d)).load(function(){d.pidModalResize(d.attr("data-modal-resize"))}))},a(".pidModalAnchor").bind("after-open.mw",function(b){var c=a(this),d=c.data("goUrl")||"";d&&a(c.attr("href")).pidModalGoUrl(d)}).bind("before-close.mw",function(b){var c=a(a(this).attr("href"));a("[data-modal-child]",c).remove(),a(".pid_modal-body",c).children().remove()}).pidModalWindow()});